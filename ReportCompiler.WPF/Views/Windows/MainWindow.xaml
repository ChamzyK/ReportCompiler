<Window x:Class="ReportCompiler.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" mc:Ignorable="d"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:ucvm="clr-namespace:ReportCompiler.WPF.ViewModels.UserControlViewModels"
        xmlns:ucv="clr-namespace:ReportCompiler.WPF.Views.UserControls"
        DataContext="{Binding Path=MainViewModel, Source={StaticResource Locator}}"
        Title="{Binding Title}"
        Height="575" Width="775"
        MinHeight="500" MinWidth="725"
        Style="{DynamicResource MaterialDesignWindow}"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style TargetType="Button" BasedOn="{StaticResource MaterialDesignRaisedButton}">
            <Setter Property="Margin" Value="5"/>
        </Style>
        <Style TargetType="GroupBox" BasedOn="{StaticResource MaterialDesignCardGroupBox}">
            <Setter Property="Margin" Value="5"/>
        </Style>
    </Window.Resources>

    <md:DialogHost>

        <md:DialogHost.DialogContentTemplate>
            <DataTemplate DataType="{x:Type ucvm:InfoViewModel}">
                <ucv:InfoView/>
            </DataTemplate>
        </md:DialogHost.DialogContentTemplate>

        <md:DialogHost.DialogContent>
            <ContentControl Content="{Binding}"/>
        </md:DialogHost.DialogContent>

        <DockPanel>
            <md:Card DockPanel.Dock="Top" 
                     Margin="5"
                     Background="{StaticResource PrimaryHueMidBrush}">
                <Menu md:MenuAssist.TopLevelMenuItemHeight="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type md:Card}},Path=ActualHeight}">

                    <MenuItem Header="Шаблон отчета"
                              Command="{Binding OpenReportTemplateCommand}"/>
                    <MenuItem Header="Руководство пользователя"
                              Command="{Binding OpenManualCommand}"/>

                    <MenuItem Header="Справка">
                        <MenuItem Header="О программе"
                              Command="{Binding AboutProgramCommand}"/>
                        <MenuItem Header="О разработчике" 
                              Command="{Binding AboutDevCommand}"/>
                    </MenuItem>

                    <MenuItem Header="Выход" 
                              Command="{StaticResource CloseWindowCommand}"/>
                </Menu>
            </md:Card>
            <DockPanel>

                <UniformGrid DockPanel.Dock="Bottom" Rows="1">
                    <Button Content="Проверить данные"
                            Command="{Binding CheckDataCommand}"
                            CommandParameter="{Binding Path=DirectoriesViewModel, Source={StaticResource Locator}}"/>
                    <Button Content="Составить сводный отчет" 
                            Command="{Binding CreateReportCommand}"
                            Style="{StaticResource MaterialDesignRaisedDarkButton}"
                            CommandParameter="{Binding Path=DirectoriesViewModel, Source={StaticResource Locator}}"
                            Margin="5"/>
                </UniformGrid>

                <GroupBox DockPanel.Dock="Left">
                    <GroupBox.Header>
                        <TextBlock Style="{DynamicResource MaterialDesignSubtitle2TextBlock}">
                            <Run Text="Заполнение данных"/>
                        </TextBlock>
                    </GroupBox.Header>

                    <StackPanel MaxWidth="200">

                        <TextBox md:HintAssist.Hint="Название сводного отчета"
                                 Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                 md:TextFieldAssist.HasClearButton="True"
                                 TextWrapping="Wrap"
                                 MaxLength="100"
                                 Margin="0,10"/>

                        <CheckBox Content="Другая дата составления"
                                  x:Name="AnotherDateCheckBox"
                                  ToolTip="По умолчанию дата составления устанавливается сегодняшним днем"
                                  IsChecked="False" 
                                  Margin="0,10,0,0"/>
                        
                        <DatePicker md:HintAssist.Hint="Дата составления"
                                    md:TextFieldAssist.HasClearButton="True"
                                    Style="{StaticResource MaterialDesignFloatingHintDatePicker}"
                                    Visibility="{Binding Path=IsChecked, ElementName=AnotherDateCheckBox, Converter={StaticResource BooleanToVisibility}}"
                                    Margin="0,10"/>

                        <CheckBox Content="Другой месяц отчетности"
                                  x:Name="AnotherMonthCheckBox"
                                  ToolTip="По умолчанию месяц отчетности совпадает с месяцем составления"
                                  IsChecked="False"
                                  Margin="0,10,0,0"/>

                        <ComboBox Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                                  md:HintAssist.HelperText="Выберите месяц"
                                  md:HintAssist.Hint="Месяц"
                                  Visibility="{Binding Path=IsChecked, ElementName=AnotherMonthCheckBox, Converter={StaticResource BooleanToVisibility}}">
                            <ComboBoxItem
                                Content="Январь"/>
                            <ComboBoxItem
                                Content="Февраль"/>
                            <ComboBoxItem
                                Content="Март"/>
                            <ComboBoxItem
                                Content="Апрель"/>
                        </ComboBox>

                    </StackPanel>

                </GroupBox>

                <GroupBox>
                    <GroupBox.Header>
                        <TextBlock Style="{DynamicResource MaterialDesignSubtitle2TextBlock}"
                                   Text="Выбор папки с отчетами"/>
                    </GroupBox.Header>

                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="65"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="65"/>
                        </Grid.ColumnDefinitions>

                        <Button Grid.Row="1"
                                Grid.Column="1"
                                Style="{StaticResource MaterialDesignFloatingActionMiniButton}"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                ToolTip="Вернуться в папку с приложением"
                                Panel.ZIndex="9999"
                                Command="{DynamicResource AppDirectoryCommand}"
                                Content="{md:PackIcon Home}"/>

                        <ucv:DirectoriesView DataContext="{Binding Path=DirectoriesViewModel, Source={StaticResource Locator}}"
                                             Grid.RowSpan="2"
                                             Grid.ColumnSpan="2"/>
                    </Grid>

                </GroupBox>

            </DockPanel>

        </DockPanel>

    </md:DialogHost>
</Window>
